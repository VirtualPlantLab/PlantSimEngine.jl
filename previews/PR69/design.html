<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Package design | PlantSimEngine.jl</title>
    <meta name="description" content="A VitePress Site">
    <meta name="generator" content="VitePress v1.1.4">
    <link rel="preload stylesheet" href="/PlantSimEngine.jl/previews/PR69/assets/style.C4BAv1PT.css" as="style">
    
    <script type="module" src="/PlantSimEngine.jl/previews/PR69/assets/app.45NAeMGs.js"></script>
    <link rel="preload" href="/PlantSimEngine.jl/previews/PR69/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/PlantSimEngine.jl/previews/PR69/assets/chunks/theme.CuzYYLar.js">
    <link rel="modulepreload" href="/PlantSimEngine.jl/previews/PR69/assets/chunks/framework.Cj43WC4E.js">
    <link rel="modulepreload" href="/PlantSimEngine.jl/previews/PR69/assets/design.md.m-k4eS7N.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c3508ec8></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c3508ec8> Skip to content </a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar has-sidebar top" data-v-f1e365da data-v-40788ea0><div class="wrapper" data-v-40788ea0><div class="container" data-v-40788ea0><div class="title" data-v-40788ea0><div class="VPNavBarTitle has-sidebar" data-v-40788ea0 data-v-28a961f9><a class="title" href="/PlantSimEngine.jl/previews/PR69/" data-v-28a961f9><!--[--><!--]--><!----><span data-v-28a961f9>PlantSimEngine.jl</span><!--[--><!--]--></a></div></div><div class="content" data-v-40788ea0><div class="content-body" data-v-40788ea0><!--[--><!--]--><div class="VPNavBarSearch search" data-v-40788ea0><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-40788ea0 data-v-492ea56d><span id="main-nav-aria-label" class="visually-hidden" data-v-492ea56d>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/PlantSimEngine.jl/previews/PR69/index" tabindex="0" data-v-492ea56d data-v-ed5ac1f6><!--[--><span data-v-ed5ac1f6>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/PlantSimEngine.jl/previews/PR69/design" tabindex="0" data-v-492ea56d data-v-ed5ac1f6><!--[--><span data-v-ed5ac1f6>Design</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/PlantSimEngine.jl/previews/PR69/model_switching" tabindex="0" data-v-492ea56d data-v-ed5ac1f6><!--[--><span data-v-ed5ac1f6>Model Switching</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/PlantSimEngine.jl/previews/PR69/reducing_dof" tabindex="0" data-v-492ea56d data-v-ed5ac1f6><!--[--><span data-v-ed5ac1f6>Reducing DoF</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/PlantSimEngine.jl/previews/PR69/model_execution" tabindex="0" data-v-492ea56d data-v-ed5ac1f6><!--[--><span data-v-ed5ac1f6>Execution</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/PlantSimEngine.jl/previews/PR69/fitting" tabindex="0" data-v-492ea56d data-v-ed5ac1f6><!--[--><span data-v-ed5ac1f6>Fitting</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-492ea56d data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e5380155><span class="text" data-v-e5380155><!----><span data-v-e5380155>Extending</span><span class="vpi-chevron-down text-icon" data-v-e5380155></span></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-97491713><div class="items" data-v-97491713><!--[--><!--[--><div class="VPMenuLink" data-v-97491713 data-v-8b74d055><a class="VPLink link" href="/PlantSimEngine.jl/previews/PR69/extending/implement_a_process" data-v-8b74d055><!--[-->Processes<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-97491713 data-v-8b74d055><a class="VPLink link" href="/PlantSimEngine.jl/previews/PR69/extending/implement_a_model" data-v-8b74d055><!--[-->Models<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-97491713 data-v-8b74d055><a class="VPLink link" href="/PlantSimEngine.jl/previews/PR69/extending/inputs" data-v-8b74d055><!--[-->Input types<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-492ea56d data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e5380155><span class="text" data-v-e5380155><!----><span data-v-e5380155>Coupling</span><span class="vpi-chevron-down text-icon" data-v-e5380155></span></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-97491713><div class="items" data-v-97491713><!--[--><!--[--><div class="VPMenuGroup" data-v-97491713 data-v-48c802d0><p class="title" data-v-48c802d0>Users</p><!--[--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-8b74d055><a class="VPLink link" href="/PlantSimEngine.jl/previews/PR69/model_coupling/model_coupling_user" data-v-8b74d055><!--[-->Simple case<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-48c802d0 data-v-8b74d055><a class="VPLink link" href="/PlantSimEngine.jl/previews/PR69/model_coupling/multiscale" data-v-8b74d055><!--[-->Multi-scale modelling<!--]--></a></div><!--]--><!--]--></div><!--]--><!--[--><div class="VPMenuLink" data-v-97491713 data-v-8b74d055><a class="VPLink link" href="/PlantSimEngine.jl/previews/PR69/model_coupling/model_coupling_modeler" data-v-8b74d055><!--[-->Modelers<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-492ea56d data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e5380155><span class="text" data-v-e5380155><!----><span data-v-e5380155>FAQ</span><span class="vpi-chevron-down text-icon" data-v-e5380155></span></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-97491713><div class="items" data-v-97491713><!--[--><!--[--><div class="VPMenuLink" data-v-97491713 data-v-8b74d055><a class="VPLink link" href="/PlantSimEngine.jl/previews/PR69/FAQ/translate_a_model" data-v-8b74d055><!--[-->Translate a model<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/PlantSimEngine.jl/previews/PR69/API" tabindex="0" data-v-492ea56d data-v-ed5ac1f6><!--[--><span data-v-ed5ac1f6>API</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-40788ea0 data-v-ead91a81><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-ead91a81 data-v-b79b56d4 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-b79b56d4></span><span class="vpi-moon moon" data-v-b79b56d4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-40788ea0 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/VirtualPlantLab/PlantSimEngine.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-717b8b75><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-40788ea0 data-v-9b536d0b data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-e5380155><span class="vpi-more-horizontal icon" data-v-e5380155></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-97491713><!----><!--[--><!--[--><!----><div class="group" data-v-9b536d0b><div class="item appearance" data-v-9b536d0b><p class="label" data-v-9b536d0b>Appearance</p><div class="appearance-action" data-v-9b536d0b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-9b536d0b data-v-b79b56d4 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-b79b56d4></span><span class="vpi-moon moon" data-v-b79b56d4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-9b536d0b><div class="item social-links" data-v-9b536d0b><div class="VPSocialLinks social-links-list" data-v-9b536d0b data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/VirtualPlantLab/PlantSimEngine.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-717b8b75><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-40788ea0 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-40788ea0><div class="divider-line" data-v-40788ea0></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-bc9dc845><button data-v-bc9dc845>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-ec846e01><div class="curtain" data-v-ec846e01></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-ec846e01><span class="visually-hidden" id="sidebar-aria-label" data-v-ec846e01> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-ec846e01><section class="VPSidebarItem level-0 has-active" data-v-ec846e01 data-v-2ea20db7><!----><div class="items" data-v-2ea20db7><!--[--><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/PlantSimEngine.jl/previews/PR69/index" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Home</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/PlantSimEngine.jl/previews/PR69/design" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Design</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/PlantSimEngine.jl/previews/PR69/model_switching" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Model Switching</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/PlantSimEngine.jl/previews/PR69/reducing_dof" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Reducing DoF</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/PlantSimEngine.jl/previews/PR69/model_execution" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Execution</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/PlantSimEngine.jl/previews/PR69/fitting" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Fitting</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-ec846e01><section class="VPSidebarItem level-0 collapsible" data-v-ec846e01 data-v-2ea20db7><div class="item" role="button" tabindex="0" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><h2 class="text" data-v-2ea20db7>Extending</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-2ea20db7><span class="vpi-chevron-right caret-icon" data-v-2ea20db7></span></div></div><div class="items" data-v-2ea20db7><!--[--><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/PlantSimEngine.jl/previews/PR69/extending/implement_a_process" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Processes</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/PlantSimEngine.jl/previews/PR69/extending/implement_a_model" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/PlantSimEngine.jl/previews/PR69/extending/inputs" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Input types</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-ec846e01><section class="VPSidebarItem level-0 collapsible" data-v-ec846e01 data-v-2ea20db7><div class="item" role="button" tabindex="0" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><h2 class="text" data-v-2ea20db7>Coupling</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-2ea20db7><span class="vpi-chevron-right caret-icon" data-v-2ea20db7></span></div></div><div class="items" data-v-2ea20db7><!--[--><section class="VPSidebarItem level-1 collapsible" data-v-2ea20db7 data-v-2ea20db7><div class="item" role="button" tabindex="0" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><h3 class="text" data-v-2ea20db7>Users</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-2ea20db7><span class="vpi-chevron-right caret-icon" data-v-2ea20db7></span></div></div><div class="items" data-v-2ea20db7><!--[--><div class="VPSidebarItem level-2 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/PlantSimEngine.jl/previews/PR69/model_coupling/model_coupling_user" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Simple case</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/PlantSimEngine.jl/previews/PR69/model_coupling/multiscale" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Multi-scale modelling</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/PlantSimEngine.jl/previews/PR69/model_coupling/model_coupling_modeler" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Modelers</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-ec846e01><section class="VPSidebarItem level-0 collapsible" data-v-ec846e01 data-v-2ea20db7><div class="item" role="button" tabindex="0" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><h2 class="text" data-v-2ea20db7>FAQ</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-2ea20db7><span class="vpi-chevron-right caret-icon" data-v-2ea20db7></span></div></div><div class="items" data-v-2ea20db7><!--[--><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/PlantSimEngine.jl/previews/PR69/FAQ/translate_a_model" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Translate a model</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-ec846e01><section class="VPSidebarItem level-0" data-v-ec846e01 data-v-2ea20db7><!----><div class="items" data-v-2ea20db7><!--[--><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/PlantSimEngine.jl/previews/PR69/API" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>API</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" role="navigation" data-v-6d7b3c46 data-v-b6ca177b><div class="content" data-v-b6ca177b><div class="outline-marker" data-v-b6ca177b></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b6ca177b>On this page</div><ul class="VPDocOutlineItem root" data-v-b6ca177b data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _PlantSimEngine_jl_previews_PR69_design" data-v-83890dd9><div><h1 id="Package-design" tabindex="-1">Package design <a class="header-anchor" href="#Package-design" aria-label="Permalink to &quot;Package design {#Package-design}&quot;">​</a></h1><p><code>PlantSimEngine.jl</code> is designed to ease the process of modelling and simulation of plants, soil and atmosphere, or really any system (<em>e.g.</em> agroforestry system, agrivoltaics...). <code>PlantSimEngine.jl</code> aims at being the backbone tool for developing Functional-Structural Plant Models (FSPM) and crop models without the hassle of performance and other computer-science considerations.</p><h2 id="Definitions" tabindex="-1">Definitions <a class="header-anchor" href="#Definitions" aria-label="Permalink to &quot;Definitions {#Definitions}&quot;">​</a></h2><h3 id="Processes" tabindex="-1">Processes <a class="header-anchor" href="#Processes" aria-label="Permalink to &quot;Processes {#Processes}&quot;">​</a></h3><p>A process in this package defines a biological or physical phenomena. Think of any process happening in a system, such as light interception, photosynthesis, water, carbon and energy fluxes, growth, yield or even electricity produced by solar panels.</p><p>A process is &quot;declared&quot;, meaning we just define a process using <a href="/PlantSimEngine.jl/previews/PR69/API#PlantSimEngine.@process-Tuple{Any, Vararg{Any}}"><code>@process</code></a>, and then we implement models for its simulation. Declaring a process generates some boilerplate code for its simulation:</p><ul><li><p>an abstract type for the process</p></li><li><p>a method for the <code>process</code> function, that is used internally</p></li></ul><p>For example, the <code>light_interception</code> process is declared using:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">@process</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> light_interception</span></span></code></pre></div><p>Which would generate a tutorial to help the user implement a model for the process.</p><p>The abstract process type is then used as a supertype of all models implementations for the process, and is named <code>Abstract&lt;process_name&gt;Process</code>, <em>e.g.</em> <code>AbstractLight_InterceptionModel</code>.</p><h3 id="Models-(ModelList)" tabindex="-1">Models (ModelList) <a class="header-anchor" href="#Models-(ModelList)" aria-label="Permalink to &quot;Models (ModelList) {#Models-(ModelList)}&quot;">​</a></h3><p>A process is simulated using a particular implementation, or <strong>a model</strong>. Each model is implemented using a structure that lists the parameters of the model. For example, PlantBiophysics provides the <a href="https://vezy.github.io/PlantBiophysics.jl/stable/functions/#PlantBiophysics.Beer" target="_blank" rel="noreferrer"><code>Beer</code></a> structure for the implementation of the Beer-Lambert law of light extinction. The process of <code>light_interception</code> and the <code>Beer</code> model are provided as an example script in this package too at <a href="https://github.com/VirtualPlantLab/PlantSimEngine.jl/blob/master/examples/Beer.jl" target="_blank" rel="noreferrer"><code>examples/Beer.jl</code></a>.</p><p>Models can use three types of entries:</p><ul><li><p>Parameters</p></li><li><p>Meteorological information</p></li><li><p>Variables</p></li><li><p>Constants</p></li><li><p>Extras</p></li></ul><p>Parameters are constant values that are used by the model to compute its outputs. Meteorological information are values that are provided by the user and are used as inputs to the model. It is defined for one time-step, and <code>PlantSimEngine.jl</code> takes care of applying the model to each time-steps given by the user. Variables are either used or computed by the model and can optionally be initialized before the simulation. Constants are constant values, usually common between models, <em>e.g.</em> the universal gas constant. And extras are just extra values that can be used by a model, it is for example used to pass the current node of the Multi-Scale Tree Graph to be able to <em>e.g.</em> retrieve children or ancestors values.</p><p>Users can choose which model is used to simulate a process using the <a href="/PlantSimEngine.jl/previews/PR69/model_switching#ModelList"><code>ModelList</code></a> structure. <code>ModelList</code> is also used to store the values of the parameters, and to initialize variables.</p><p>For example let&#39;s instantiate a <a href="/PlantSimEngine.jl/previews/PR69/model_switching#ModelList"><code>ModelList</code></a> with the Beer-Lambert model of light extinction. The model is implemented with the <a href="https://github.com/VirtualPlantLab/PlantSimEngine.jl/blob/master/examples/Beer.jl" target="_blank" rel="noreferrer"><code>Beer</code></a> structure and has only one parameter: the extinction coefficient (<code>k</code>).</p><p>Importing the package:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PlantSimEngine</span></span></code></pre></div><p>Import the examples defined in the <code>Examples</code> sub-module (<code>light_interception</code> and <code>Beer</code>):</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PlantSimEngine</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Examples</span></span></code></pre></div><p>And then making a <a href="/PlantSimEngine.jl/previews/PR69/model_switching#ModelList"><code>ModelList</code></a> with the <code>Beer</code> model:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ModelList</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Beer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>PlantSimEngine.DependencyGraph{Dict{Symbol, PlantSimEngine.SoftDependencyNode}}(Dict{Symbol, PlantSimEngine.SoftDependencyNode}(:light_interception =&gt; PlantSimEngine.Examples.Beer{Float64}</span></span>
<span class="line"><span>), Dict{Symbol, DataType}())TimeStepTable{Status{(:LAI, :aPPFD), Tuple{...}(1 x 2):</span></span>
<span class="line"><span>╭─────┬─────────┬─────────╮</span></span>
<span class="line"><span>│ Row │     LAI │   aPPFD │</span></span>
<span class="line"><span>│     │ Float64 │ Float64 │</span></span>
<span class="line"><span>├─────┼─────────┼─────────┤</span></span>
<span class="line"><span>│   1 │    -Inf │    -Inf │</span></span>
<span class="line"><span>╰─────┴─────────┴─────────╯</span></span></code></pre></div><p>What happened here? We provided an instance of the <code>Beer</code> model to a <a href="/PlantSimEngine.jl/previews/PR69/model_switching#ModelList"><code>ModelList</code></a> to simulate the light interception process.</p><h2 id="Parameters" tabindex="-1">Parameters <a class="header-anchor" href="#Parameters" aria-label="Permalink to &quot;Parameters {#Parameters}&quot;">​</a></h2><p>A parameter is a constant value that is used by a model to compute its outputs. For example, the Beer-Lambert model uses the extinction coefficient (<code>k</code>) to compute the light extinction. The Beer-Lambert model is implemented with the <code>Beer</code> structure, which has only one field: <code>k</code>. We can see that using <code>fieldnames</code> on the model structure:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fieldnames</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Beer)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>(:k,)</span></span></code></pre></div><h2 id="Variables-(inputs,-outputs)" tabindex="-1">Variables (inputs, outputs) <a class="header-anchor" href="#Variables-(inputs,-outputs)" aria-label="Permalink to &quot;Variables (inputs, outputs) {#Variables-(inputs,-outputs)}&quot;">​</a></h2><p>Variables are either input or outputs (<em>i.e.</em> computed) of models. Variables and their values are stored in the <a href="/PlantSimEngine.jl/previews/PR69/model_switching#ModelList"><code>ModelList</code></a> structure, and are initialized automatically or manually.</p><p>Hence, <a href="/PlantSimEngine.jl/previews/PR69/model_switching#ModelList"><code>ModelList</code></a> objects stores two fields:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">fieldnames</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ModelList)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>(:models, :status, :vars_not_propagated)</span></span></code></pre></div><p>The first field is a list of models associated to the processes they simulate. The second, <code>:status</code>, is used to hold all inputs and outputs of our models, called variables. For example the <code>Beer</code> model needs the leaf area index (<code>LAI</code>, m² m⁻²) to run.</p><p>We can see which variables are needed as inputs using <a href="/PlantSimEngine.jl/previews/PR69/API#PlantSimEngine.inputs-Tuple{T} where T&lt;:AbstractModel"><code>inputs</code></a>:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">inputs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Beer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>(:LAI,)</span></span></code></pre></div><p>and the outputs of the model using <a href="/PlantSimEngine.jl/previews/PR69/API#PlantSimEngine.outputs-Tuple{PlantSimEngine.GraphSimulation, Any}"><code>outputs</code></a>:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">outputs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Beer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>(:aPPFD,)</span></span></code></pre></div><p>If we instantiate a <a href="/PlantSimEngine.jl/previews/PR69/model_switching#ModelList"><code>ModelList</code></a> with the Beer-Lambert model, we can see that the <code>:status</code> field has two variables: <code>LAI</code> and <code>PPFD</code>. The first is an input, the second an output (<em>i.e.</em> it is computed by the model).</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ModelList</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Beer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">keys</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>(:LAI, :aPPFD)</span></span></code></pre></div><p>To know which variables should be initialized, we can use <a href="/PlantSimEngine.jl/previews/PR69/API#PlantSimEngine.to_initialize-Tuple{ModelList}"><code>to_initialize</code></a>:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ModelList</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Beer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">to_initialize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>(light_interception = (:LAI,),)</span></span></code></pre></div><p>Their values are uninitialized though (hence the warnings):</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:LAI</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], m[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:aPPFD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>([-Inf], [-Inf])</span></span></code></pre></div><p>Uninitialized variables are initialized to the value given in the <code>inputs</code> or <code>outputs</code> methods, which is usually equal to <code>typemin()</code>, <em>e.g.</em> <code>-Inf</code> for <code>Float64</code>.</p><div class="tip custom-block"><p class="custom-block-title">Tip</p><p>Prefer using <code>to_initialize</code> rather than <code>inputs</code> to check which variables should be initialized. <code>inputs</code> returns the variables that are needed by the model to run, but <code>to_initialize</code> returns the variables that are needed by the model to run and that are not initialized in the <code>ModelList</code>. Also <code>to_initialize</code> is more clever when coupling models (see below).</p></div><p>We can initialize the variables by providing their values to the status at instantiation:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ModelList</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Beer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (LAI </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,))</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>PlantSimEngine.DependencyGraph{Dict{Symbol, PlantSimEngine.SoftDependencyNode}}(Dict{Symbol, PlantSimEngine.SoftDependencyNode}(:light_interception =&gt; PlantSimEngine.Examples.Beer{Float64}</span></span>
<span class="line"><span>), Dict{Symbol, DataType}())TimeStepTable{Status{(:LAI, :aPPFD), Tuple{...}(1 x 2):</span></span>
<span class="line"><span>╭─────┬─────────┬─────────╮</span></span>
<span class="line"><span>│ Row │     LAI │   aPPFD │</span></span>
<span class="line"><span>│     │ Float64 │ Float64 │</span></span>
<span class="line"><span>├─────┼─────────┼─────────┤</span></span>
<span class="line"><span>│   1 │     2.0 │    -Inf │</span></span>
<span class="line"><span>╰─────┴─────────┴─────────╯</span></span></code></pre></div><p>Or after instantiation using <a href="/PlantSimEngine.jl/previews/PR69/API#PlantSimEngine.init_status!-Tuple{Dict{String, ModelList}}"><code>init_status!</code></a>:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ModelList</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Beer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">init_status!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m, LAI </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>[ Info: Some variables must be initialized before simulation: (light_interception = (:LAI,),) (see `to_initialize()`)</span></span></code></pre></div><p>We can check if a component is correctly initialized using <a href="/PlantSimEngine.jl/previews/PR69/API#PlantSimEngine.is_initialized-Tuple{T} where T&lt;:ModelList"><code>is_initialized</code></a>:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">is_initialized</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>true</span></span></code></pre></div><p>Some variables are inputs of models, but outputs of other models. When we couple models, <code>PlantSimEngine.jl</code> is clever and only requests the variables that are not computed by other models.</p><h2 id="Climate-forcing" tabindex="-1">Climate forcing <a class="header-anchor" href="#Climate-forcing" aria-label="Permalink to &quot;Climate forcing {#Climate-forcing}&quot;">​</a></h2><p>To make a simulation, we usually need the climatic/meteorological conditions measured close to the object or component.</p><p>Users are strongly encouraged to use <a href="https://github.com/PalmStudio/PlantMeteo.jl" target="_blank" rel="noreferrer"><code>PlantMeteo.jl</code></a>, the companion package that helps manage such data, with default pre-computations and structures for efficient computations. The most basic data structure from this package is a type called <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.Atmosphere" target="_blank" rel="noreferrer"><code>Atmosphere</code></a>, which defines steady-state atmospheric conditions, <em>i.e.</em> the conditions are considered at equilibrium. Another structure is available to define different consecutive time-steps: <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.TimeStepTable" target="_blank" rel="noreferrer"><code>TimeStepTable</code></a>.</p><p>The mandatory variables to provide for an <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.Atmosphere" target="_blank" rel="noreferrer"><code>Atmosphere</code></a> are: <code>T</code> (air temperature in °C), <code>Rh</code> (relative humidity, 0-1) and <code>Wind</code> (the wind speed, m s⁻¹). In our example, we also need the incoming photosynthetically active radiation flux (<code>Ri_PAR_f</code>, W m⁻²). We can declare such conditions like so:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PlantMeteo</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meteo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Atmosphere</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Wind </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Rh </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.65</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Ri_PAR_f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 500.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>Atmosphere(date = Dates.DateTime(&quot;2024-05-17T12:05:25.231&quot;), duration = Dates.Second(1), T = 20.0, Wind = 1.0, P = 101.325, Rh = 0.65, Precipitations = 0.0, Cₐ = 400.0, e = 1.5255470730405223, eₛ = 2.3469954969854188, VPD = 0.8214484239448965, ρ = 1.2040822421461452, λ = 2.4537e6, γ = 0.06725339460440805, ε = 0.5848056484857892, Δ = 0.14573378083416522, clearness = Inf, Ri_SW_f = Inf, Ri_PAR_f = 500.0, Ri_NIR_f = Inf, Ri_TIR_f = Inf, Ri_custom_f = Inf)</span></span></code></pre></div><p>More details are available from the <a href="https://vezy.github.io/PlantMeteo.jl/stable" target="_blank" rel="noreferrer">package documentation</a>.</p><h2 id="Simulation" tabindex="-1">Simulation <a class="header-anchor" href="#Simulation" aria-label="Permalink to &quot;Simulation {#Simulation}&quot;">​</a></h2><h3 id="Simulation-of-processes" tabindex="-1">Simulation of processes <a class="header-anchor" href="#Simulation-of-processes" aria-label="Permalink to &quot;Simulation of processes {#Simulation-of-processes}&quot;">​</a></h3><p>Making a simulation is rather simple, we simply use <a href="/PlantSimEngine.jl/previews/PR69/API#PlantSimEngine.run!"><code>run!</code></a> on the <code>ModelList</code>:</p><p>The call to <a href="/PlantSimEngine.jl/previews/PR69/API#PlantSimEngine.run!"><code>run!</code></a> is the same whatever the models you choose for simulating the processes. This is some magic allowed by <code>PlantSimEngine.jl</code>! Here is an example:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">run!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model_list, meteo)</span></span></code></pre></div><p>The first argument is the model list (see <a href="/PlantSimEngine.jl/previews/PR69/model_switching#ModelList"><code>ModelList</code></a>), and the second defines the micro-climatic conditions.</p><p>The <code>ModelList</code> should be initialized for the given process before calling the function. See <a href="/PlantSimEngine.jl/previews/PR69/design#Variables-(inputs,-outputs)">Variables (inputs, outputs)</a> for more details.</p><h3 id="Example-simulation" tabindex="-1">Example simulation <a class="header-anchor" href="#Example-simulation" aria-label="Permalink to &quot;Example simulation {#Example-simulation}&quot;">​</a></h3><p>For example we can simulate the <code>light_interception</code> of a leaf like so:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PlantSimEngine, PlantMeteo</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Import the examples defined in the `Examples` sub-module</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PlantSimEngine</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Examples</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">meteo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Atmosphere</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 20.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Wind </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Rh </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.65</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Ri_PAR_f </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 500.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">leaf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ModelList</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Beer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (LAI </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">run!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(leaf, meteo)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">leaf[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:aPPFD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>1-element Vector{Float64}:</span></span>
<span class="line"><span> 1444.3954769232544</span></span></code></pre></div><h3 id="Outputs" tabindex="-1">Outputs <a class="header-anchor" href="#Outputs" aria-label="Permalink to &quot;Outputs {#Outputs}&quot;">​</a></h3><p>The <code>status</code> field of a <a href="/PlantSimEngine.jl/previews/PR69/model_switching#ModelList"><code>ModelList</code></a> is used to initialize the variables before simulation and then to keep track of their values during and after the simulation. We can extract the simulation outputs of a model list using the <a href="/PlantSimEngine.jl/previews/PR69/API#PlantSimEngine.status-Tuple{Any}"><code>status</code></a> function.</p><p>The status is usually stored in a <code>TimeStepTable</code> structure from <code>PlantMeteo.jl</code>, which is a fast DataFrame-alike structure with each time step being a <a href="/PlantSimEngine.jl/previews/PR69/API#PlantSimEngine.Status"><code>Status</code></a>. It can be also be any <code>Tables.jl</code> structure, such as a regular <code>DataFrame</code>. The weather is also usually stored in a <code>TimeStepTable</code> but with each time step being an <code>Atmosphere</code>.</p><p>Let&#39;s look at the status of our previous simulated leaf:</p><p>We can extract the value of one variable using the <code>status</code> function, <em>e.g.</em> for the intercepted light:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">status</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(leaf, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:aPPFD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>1-element Vector{Float64}:</span></span>
<span class="line"><span> 1444.3954769232544</span></span></code></pre></div><p>Or similarly using the dot syntax:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">leaf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">aPPFD</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>1-element Vector{Float64}:</span></span>
<span class="line"><span> 1444.3954769232544</span></span></code></pre></div><p>Or much simpler (and recommended), by indexing directly into the model list:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">leaf[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">:aPPFD</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>1-element Vector{Float64}:</span></span>
<span class="line"><span> 1444.3954769232544</span></span></code></pre></div><p>Another simple way to get the results is to transform the outputs into a <code>DataFrame</code>. Which is very easy because the <code>TimeStepTable</code> implements the Tables.jl interface:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DataFrames</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DataFrame</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(leaf)</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>The output from <code>DataFrame</code> is adapted to the kind of simulation you did: one row per time-step, and per component models if you simulated several.</p></div><h2 id="Model-coupling" tabindex="-1">Model coupling <a class="header-anchor" href="#Model-coupling" aria-label="Permalink to &quot;Model coupling {#Model-coupling}&quot;">​</a></h2><p>A model can work either independently or in conjunction with other models. For example a stomatal conductance model is often associated with a photosynthesis model, <em>i.e.</em> it is called from the photosynthesis model.</p><p><code>PlantSimEngine.jl</code> is designed to make model coupling painless for modelers and users. Please see <a href="/PlantSimEngine.jl/previews/PR69/model_coupling/model_coupling_user#Model-coupling-for-users">Model coupling for users</a> and <a href="/PlantSimEngine.jl/previews/PR69/model_coupling/model_coupling_modeler#Model-coupling-for-modelers">Model coupling for modelers</a> for more details.</p></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-b88cabfa><!--[--><!--]--><div class="edit-info" data-v-b88cabfa><div class="edit-link" data-v-b88cabfa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://https://github.com/VirtualPlantLab/PlantSimEngine.jl/edit/main/docs/src/design.md" target="_blank" rel="noreferrer" data-v-b88cabfa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-b88cabfa></span> Edit this page<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-b88cabfa><span class="visually-hidden" id="doc-footer-aria-label" data-v-b88cabfa>Pager</span><div class="pager" data-v-b88cabfa><a class="VPLink link pager-link prev" href="/PlantSimEngine.jl/previews/PR69/index" data-v-b88cabfa><!--[--><span class="desc" data-v-b88cabfa>Previous page</span><span class="title" data-v-b88cabfa>Home</span><!--]--></a></div><div class="pager" data-v-b88cabfa><a class="VPLink link pager-link next" href="/PlantSimEngine.jl/previews/PR69/model_switching" data-v-b88cabfa><!--[--><span class="desc" data-v-b88cabfa>Next page</span><span class="title" data-v-b88cabfa>Model Switching</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://luxdl.github.io/DocumenterVitepress.jl/dev/" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br></p><p class="copyright" data-v-c970a860>© Copyright 2024.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"extending_inputs.md\":\"B-z9m0gd\",\"model_coupling_model_coupling_user.md\":\"BeY7vn-L\",\"model_execution.md\":\"CzMHGcCX\",\"fitting.md\":\"DfLJyNNN\",\"design.md\":\"m-k4eS7N\",\"extending_implement_a_model.md\":\"dAwX4FRQ\",\"extending_implement_a_process.md\":\"CjkywTRz\",\"model_coupling_multiscale.md\":\"OPlq4Yun\",\"faq_translate_a_model.md\":\"S8fMh4SL\",\"model_coupling_model_coupling_modeler.md\":\"BfddkEF9\",\"model_switching.md\":\"sf6bZa0q\",\"index.md\":\"DkIRMko_\",\"reducing_dof.md\":\"Dvst-qti\",\"api.md\":\"WTakrMwB\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"PlantSimEngine.jl\",\"description\":\"A VitePress Site\",\"base\":\"/PlantSimEngine.jl/previews/PR69/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Home\",\"link\":\"/index\"},{\"text\":\"Design\",\"link\":\"/design\"},{\"text\":\"Model Switching\",\"link\":\"/model_switching\"},{\"text\":\"Reducing DoF\",\"link\":\"/reducing_dof\"},{\"text\":\"Execution\",\"link\":\"/model_execution\"},{\"text\":\"Fitting\",\"link\":\"/fitting\"},{\"text\":\"Extending\",\"collapsed\":false,\"items\":[{\"text\":\"Processes\",\"link\":\"/./extending/implement_a_process\"},{\"text\":\"Models\",\"link\":\"/./extending/implement_a_model\"},{\"text\":\"Input types\",\"link\":\"/./extending/inputs\"}]},{\"text\":\"Coupling\",\"collapsed\":false,\"items\":[{\"text\":\"Users\",\"collapsed\":false,\"items\":[{\"text\":\"Simple case\",\"link\":\"/./model_coupling/model_coupling_user\"},{\"text\":\"Multi-scale modelling\",\"link\":\"/./model_coupling/multiscale\"}]},{\"text\":\"Modelers\",\"link\":\"/./model_coupling/model_coupling_modeler\"}]},{\"text\":\"FAQ\",\"collapsed\":false,\"items\":[{\"text\":\"Translate a model\",\"link\":\"/./FAQ/translate_a_model\"}]},{\"text\":\"API\",\"link\":\"/API\"}],\"sidebar\":[{\"text\":\"Home\",\"link\":\"/index\"},{\"text\":\"Design\",\"link\":\"/design\"},{\"text\":\"Model Switching\",\"link\":\"/model_switching\"},{\"text\":\"Reducing DoF\",\"link\":\"/reducing_dof\"},{\"text\":\"Execution\",\"link\":\"/model_execution\"},{\"text\":\"Fitting\",\"link\":\"/fitting\"},{\"text\":\"Extending\",\"collapsed\":false,\"items\":[{\"text\":\"Processes\",\"link\":\"/./extending/implement_a_process\"},{\"text\":\"Models\",\"link\":\"/./extending/implement_a_model\"},{\"text\":\"Input types\",\"link\":\"/./extending/inputs\"}]},{\"text\":\"Coupling\",\"collapsed\":false,\"items\":[{\"text\":\"Users\",\"collapsed\":false,\"items\":[{\"text\":\"Simple case\",\"link\":\"/./model_coupling/model_coupling_user\"},{\"text\":\"Multi-scale modelling\",\"link\":\"/./model_coupling/multiscale\"}]},{\"text\":\"Modelers\",\"link\":\"/./model_coupling/model_coupling_modeler\"}]},{\"text\":\"FAQ\",\"collapsed\":false,\"items\":[{\"text\":\"Translate a model\",\"link\":\"/./FAQ/translate_a_model\"}]},{\"text\":\"API\",\"link\":\"/API\"}],\"editLink\":{\"pattern\":\"https://https://github.com/VirtualPlantLab/PlantSimEngine.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/VirtualPlantLab/PlantSimEngine.jl\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/dev/\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>\",\"copyright\":\"© Copyright 2024.\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>
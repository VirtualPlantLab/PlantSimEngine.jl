<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Detailed first simulation · PlantSimEngine.jl</title><meta name="title" content="Detailed first simulation · PlantSimEngine.jl"/><meta property="og:title" content="Detailed first simulation · PlantSimEngine.jl"/><meta property="twitter:title" content="Detailed first simulation · PlantSimEngine.jl"/><meta name="description" content="Documentation for PlantSimEngine.jl."/><meta property="og:description" content="Documentation for PlantSimEngine.jl."/><meta property="twitter:description" content="Documentation for PlantSimEngine.jl."/><meta property="og:url" content="https://VirtualPlantLab.github.io/PlantSimEngine.jl/step_by_step/detailed_first_example/"/><meta property="twitter:url" content="https://VirtualPlantLab.github.io/PlantSimEngine.jl/step_by_step/detailed_first_example/"/><link rel="canonical" href="https://VirtualPlantLab.github.io/PlantSimEngine.jl/step_by_step/detailed_first_example/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PlantSimEngine.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../../introduction/why_plantsimengine/">Why PlantSimEngine ?</a></li><li><a class="tocitem" href="../../introduction/why_julia/">Why Julia ?</a></li></ul></li><li><span class="tocitem">Prerequisites</span><ul><li><a class="tocitem" href="../../prerequisites/key_concepts/">Key Concepts</a></li><li><a class="tocitem" href="../../prerequisites/julia_basics/">Julia language basics</a></li></ul></li><li><span class="tocitem">Step by step - Single-scale simulations</span><ul><li class="is-active"><a class="tocitem" href>Detailed first simulation</a><ul class="internal"><li><a class="tocitem" href="#Definitions"><span>Definitions</span></a></li><li><a class="tocitem" href="#Parameters"><span>Parameters</span></a></li><li><a class="tocitem" href="#Variables-(inputs,-outputs)"><span>Variables (inputs, outputs)</span></a></li><li><a class="tocitem" href="#Climate-forcing"><span>Climate forcing</span></a></li><li><a class="tocitem" href="#Simulation"><span>Simulation</span></a></li><li><a class="tocitem" href="#Model-coupling"><span>Model coupling</span></a></li></ul></li><li><a class="tocitem" href="../simple_model_coupling/">Coupling</a></li><li><a class="tocitem" href="../model_switching/">Model Switching</a></li><li><a class="tocitem" href="../quick_and_dirty_examples/">Quick examples</a></li><li><a class="tocitem" href="../implement_a_process/">Implementing a process</a></li><li><a class="tocitem" href="../implement_a_model/">Implementing a model</a></li><li><a class="tocitem" href="../parallelization/">Parallelization</a></li><li><a class="tocitem" href="../advanced_coupling/">Advanced coupling and hard dependencies</a></li><li><a class="tocitem" href="../implement_a_model_additional/">Implementing a model : additional notes</a></li></ul></li><li><a class="tocitem" href="../../model_execution/">Execution</a></li><li><span class="tocitem">Working with data</span><ul><li><a class="tocitem" href="../../working_with_data/reducing_dof/">Reducing DoF</a></li><li><a class="tocitem" href="../../working_with_data/fitting/">Fitting</a></li><li><a class="tocitem" href="../../working_with_data/inputs/">Input types</a></li><li><a class="tocitem" href="../../working_with_data/visualising_outputs/">Visualizing outputs</a></li><li><a class="tocitem" href="../../working_with_data/floating_point_accumulation_error/">Floating-point considerations</a></li></ul></li><li><span class="tocitem">Moving to multiscale</span><ul><li><a class="tocitem" href="../../multiscale/multiscale_considerations/">Multiscale considerations</a></li><li><a class="tocitem" href="../../multiscale/single_to_multiscale/">Converting a simulation to multi-scale</a></li><li><a class="tocitem" href="../../multiscale/multiscale/">More variable mapping examples</a></li><li><a class="tocitem" href="../../multiscale/multiscale_cyclic/">Handling cyclic dependencies</a></li><li><a class="tocitem" href="../../multiscale/multiscale_coupling/">Multiscale coupling considerations</a></li><li><input class="collapse-toggle" id="menuitem-7-6" type="checkbox"/><label class="tocitem" for="menuitem-7-6"><span class="docs-label">Building a simple plant</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../multiscale/multiscale_example_1/">A rudimentary plant simulation</a></li><li><a class="tocitem" href="../../multiscale/multiscale_example_2/">Expanding the plant simulation</a></li><li><a class="tocitem" href="../../multiscale/multiscale_example_3/">Fixing bugs in the plant simulation</a></li></ul></li></ul></li><li><span class="tocitem">Troubleshooting and testing</span><ul><li><a class="tocitem" href="../../troubleshooting_and_testing/plantsimengine_and_julia_troubleshooting/">Troubleshooting</a></li><li><a class="tocitem" href="../../troubleshooting_and_testing/downstream_tests/">Automated testing</a></li><li><a class="tocitem" href="../../troubleshooting_and_testing/tips_and_workarounds/">Tips and Workarounds</a></li><li><a class="tocitem" href="../../troubleshooting_and_testing/implicit_contracts/">Implicit contracts</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../API/API_public/">Public API</a></li><li><a class="tocitem" href="../../API/API_private/">Internal API</a></li></ul></li><li><a class="tocitem" href="../../credits/">Credits</a></li><li><a class="tocitem" href="../../documentation_improvement/">Improving our documentation</a></li><li><a class="tocitem" href="../../planned_features/">Planned features</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Step by step - Single-scale simulations</a></li><li class="is-active"><a href>Detailed first simulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Detailed first simulation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/VirtualPlantLab/PlantSimEngine.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/VirtualPlantLab/PlantSimEngine.jl/blob/main/docs/src/step_by_step/detailed_first_example.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Detailed-walkthrough-of-a-simple-simulation"><a class="docs-heading-anchor" href="#Detailed-walkthrough-of-a-simple-simulation">Detailed walkthrough of a simple simulation</a><a id="Detailed-walkthrough-of-a-simple-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Detailed-walkthrough-of-a-simple-simulation" title="Permalink"></a></h1><p>This page walks you through the ins and outs of a basic simulation, mostly aimed at people who have less experience programming, to showcase the various concepts presented earlier and requirements for a simulation in context.</p><p>A working trimmed-down script can be found further down in the <a href="#Example-simulation">Example simulation</a>, and other subsections in this page will detail setup and helper functions, and querying outputs.</p><ul><li><a href="#Detailed-walkthrough-of-a-simple-simulation">Detailed walkthrough of a simple simulation</a></li><li class="no-marker"><ul><li><a href="#Definitions">Definitions</a></li><li class="no-marker"><ul><li><a href="#Processes">Processes</a></li><li><a href="#Models-(ModelList)">Models (ModelList)</a></li></ul></li><li><a href="#Parameters">Parameters</a></li><li><a href="#Variables-(inputs,-outputs)">Variables (inputs, outputs)</a></li><li><a href="#Climate-forcing">Climate forcing</a></li><li><a href="#Simulation">Simulation</a></li><li class="no-marker"><ul><li><a href="#Simulation-of-processes">Simulation of processes</a></li><li><a href="#Example-simulation">Example simulation</a></li><li><a href="#Outputs">Outputs</a></li></ul></li><li><a href="#Model-coupling">Model coupling</a></li></ul></li></ul><h2 id="Definitions"><a class="docs-heading-anchor" href="#Definitions">Definitions</a><a id="Definitions-1"></a><a class="docs-heading-anchor-permalink" href="#Definitions" title="Permalink"></a></h2><h3 id="Processes"><a class="docs-heading-anchor" href="#Processes">Processes</a><a id="Processes-1"></a><a class="docs-heading-anchor-permalink" href="#Processes" title="Permalink"></a></h3><p>A process in this package defines a biological or physical phenomena. Think of any process happening in a system, such as light interception, photosynthesis, water, carbon and energy fluxes, growth, yield or even electricity produced by solar panels.</p><p>A process is &quot;declared&quot;, meaning we define a process, and then implement models for its simulation. In this example, we will make use of a process that was already defined, and for which there already is a model implementation.</p><h3 id="Models-(ModelList)"><a class="docs-heading-anchor" href="#Models-(ModelList)">Models (ModelList)</a><a id="Models-(ModelList)-1"></a><a class="docs-heading-anchor-permalink" href="#Models-(ModelList)" title="Permalink"></a></h3><p>A process is simulated using a particular implementation, or <strong>a model</strong>. Each model is implemented using a structure that lists the parameters of the model. For example, PlantBiophysics provides the <a href="https://vezy.github.io/PlantBiophysics.jl/stable/functions/#PlantBiophysics.Beer"><code>Beer</code></a> structure for the implementation of the Beer-Lambert law of light extinction. The process of <code>light_interception</code> and the <code>Beer</code> model are provided as an example  script in this package too at <a href="https://github.com/VirtualPlantLab/PlantSimEngine.jl/blob/master/examples/Beer.jl"><code>examples/Beer.jl</code></a>.</p><p>Models can use several types of entries:</p><ul><li><p>Parameters</p></li><li><p>Meteorological information</p></li><li><p>Variables</p></li><li><p>Constants</p></li><li><p>Extras</p></li><li><p>Parameters are constant values that are used by the model to compute its outputs, and are exclusive to that model. </p></li><li><p>Meteorological information contains values that are provided by the user and are used as inputs to the model. It is defined for one time-step, and <code>PlantSimEngine.jl</code> takes care of applying the model to each time-steps given by the user. </p></li><li><p>Variables are either used or computed by the model and can optionally be initialized before the simulation. They can be part of multiple models, computed by one and then used as an input by another. They can also be a global simulation output, or be provided at the start of a simulation by the user. </p></li><li><p>Constants are constant values, usually common between models, <em>e.g.</em> the universal gas constant. And extras are just extra values that can be used by a model.</p></li></ul><p>Users declare a set of models used for simulation, as well as the necessary parameters for each model, and whatever variables need to be initialized. This is done using a <a href="../simple_model_coupling/#ModelList"><code>ModelList</code></a> structure. </p><p>For example let&#39;s instantiate a <a href="../simple_model_coupling/#ModelList"><code>ModelList</code></a> with a single model : the Beer-Lambert model of light extinction, used to simulate the light interception process. The model is implemented with the <a href="https://github.com/VirtualPlantLab/PlantSimEngine.jl/blob/master/examples/Beer.jl"><code>Beer</code></a> structure and only has one parameter: the extinction coefficient (<code>k</code>).</p><p>Importing the package:</p><pre><code class="language-julia hljs">using PlantSimEngine</code></pre><p>Import the examples defined in the <code>Examples</code> sub-module (<code>light_interception</code> and <code>Beer</code>):</p><pre><code class="language-julia hljs">using PlantSimEngine.Examples</code></pre><p>And then declare a <a href="../simple_model_coupling/#ModelList"><code>ModelList</code></a> with the <code>Beer</code> model:</p><pre><code class="language-julia hljs">m = ModelList(Beer(0.5))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PlantSimEngine.DependencyGraph{Dict{Symbol, PlantSimEngine.SoftDependencyNode}, Any}(Dict{Symbol, PlantSimEngine.SoftDependencyNode}(:light_interception =&gt; PlantSimEngine.Examples.Beer{Float64}
), Dict{Symbol, Any}())Status(LAI = -Inf, aPPFD = -Inf)</code></pre><p>What happened here? We provided an instance of the <code>Beer</code> model to a <a href="../simple_model_coupling/#ModelList"><code>ModelList</code></a> to simulate the light interception process.</p><h2 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h2><p>A parameter is a value constant for a simulation that is internal to a model and used for its computations. For example, the Beer-Lambert model uses the extinction coefficient (<code>k</code>) to compute the light extinction. The <code>Beer</code> structure in the Beer-Lambert model implementation,  only has one field: <code>k</code>. We can see that using <code>fieldnames</code> on the model structure:</p><pre><code class="language-julia hljs">fieldnames(Beer)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(:k,)</code></pre><h2 id="Variables-(inputs,-outputs)"><a class="docs-heading-anchor" href="#Variables-(inputs,-outputs)">Variables (inputs, outputs)</a><a id="Variables-(inputs,-outputs)-1"></a><a class="docs-heading-anchor-permalink" href="#Variables-(inputs,-outputs)" title="Permalink"></a></h2><p>Variables are either inputs or outputs (<em>i.e.</em> computed) of models. Variables and their values are stored in the <a href="../simple_model_coupling/#ModelList"><code>ModelList</code></a> structure, and are initialized automatically or manually.</p><p>For example, the <code>Beer</code> model needs the leaf area index (<code>LAI</code>, m² m⁻²) to run.</p><p>We can see which variables are passed in as inputs using <a href="../../API/API_public/#PlantSimEngine.inputs-Tuple{T} where T&lt;:AbstractModel"><code>inputs</code></a>:</p><pre><code class="language-julia hljs">inputs(Beer(0.5))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(:LAI,)</code></pre><p>and which are computed outputs of the model using <a href="../../API/API_public/#PlantSimEngine.outputs-Tuple{T} where T&lt;:AbstractModel"><code>outputs</code></a>:</p><pre><code class="language-julia hljs">outputs(Beer(0.5))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(:aPPFD,)</code></pre><p>The <a href="../simple_model_coupling/#ModelList"><code>ModelList</code></a> structure will keep track of every variable&#39;s current state when running the simulation, storing them in a field called <code>status</code>. We can inspect that field with the <code>status</code> function and see that in our example it has two variables: <code>LAI</code> and <code>PPFD</code>. The first is an input, the second an output (<em>i.e.</em> it is computed by the model).</p><pre><code class="language-julia hljs">m = ModelList(Beer(0.5))
keys(status(m))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(:LAI, :aPPFD)</code></pre><p>To know which variables should be initialized, we can use <a href="../../API/API_public/#PlantSimEngine.to_initialize-Tuple{ModelList}"><code>to_initialize</code></a>:</p><pre><code class="language-julia hljs">m = ModelList(Beer(0.5))
to_initialize(m)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(light_interception = (:LAI,),)</code></pre><p>Their values are uninitialized though (hence the warnings):</p><pre><code class="language-julia hljs">(m[:LAI], m[:aPPFD])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(-Inf, -Inf)</code></pre><p>Uninitialized variables are initialized to the value given in the <code>inputs</code> or <code>outputs</code> methods in the model&#39;s implementation code, which is usually equal to <code>typemin()</code>, <em>e.g.</em> <code>-Inf</code> for <code>Float64</code>.</p><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>Prefer using <code>to_initialize</code> rather than <code>inputs</code> to check which variables should be initialized. <code>inputs</code> returns every variable that is needed by the model to run, but in multi-model simulations, some of them may already be computed by other models and not require initialization. <code>to_initialize</code> returns <strong>only</strong> the variables that are needed by the model to run and that are not initialized in the <code>ModelList</code>.</p></div></div><p>We can initialize the required variables by providing their starting values to the status when declaring the <code>ModelList</code>:</p><pre><code class="language-julia hljs">m = ModelList(Beer(0.5), status = (LAI = 2.0,))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PlantSimEngine.DependencyGraph{Dict{Symbol, PlantSimEngine.SoftDependencyNode}, Any}(Dict{Symbol, PlantSimEngine.SoftDependencyNode}(:light_interception =&gt; PlantSimEngine.Examples.Beer{Float64}
), Dict{Symbol, Any}())Status(LAI = 2.0, aPPFD = -Inf)</code></pre><p>Or after instantiation using <a href="../../API/API_public/#PlantSimEngine.init_status!-Tuple{Dict{String, ModelList}}"><code>init_status!</code></a>:</p><pre><code class="language-julia hljs">m = ModelList(Beer(0.5))

init_status!(m, LAI = 2.0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr36"><span class="sgr1">[ Info: </span></span>Some variables must be initialized before simulation: (light_interception = (:LAI,),) (see `to_initialize()`)</code></pre><p>We can check if a component is correctly initialized using <a href="../../API/API_public/#PlantSimEngine.is_initialized-Tuple{T} where T&lt;:ModelList"><code>is_initialized</code></a>:</p><pre><code class="language-julia hljs">is_initialized(m)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>Some variables are inputs of models, but outputs of other models. When we couple models, <code>to_initialize</code> only requests the variables that are not computed by other models.</p><h2 id="Climate-forcing"><a class="docs-heading-anchor" href="#Climate-forcing">Climate forcing</a><a id="Climate-forcing-1"></a><a class="docs-heading-anchor-permalink" href="#Climate-forcing" title="Permalink"></a></h2><p>To make a simulation, we usually need the climatic/meteorological conditions measured close to the object or component.</p><p>Users are strongly encouraged to use <a href="https://github.com/PalmStudio/PlantMeteo.jl"><code>PlantMeteo.jl</code></a>, the companion package that helps manage such data, with default pre-computations and structures for efficient computations. The most basic data structure from this package is a type called <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.Atmosphere"><code>Atmosphere</code></a>, which defines steady-state atmospheric conditions, <em>i.e.</em> the conditions are considered at equilibrium. Another structure is available to define different consecutive time-steps: <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.TimeStepTable"><code>TimeStepTable</code></a>.</p><p>The mandatory variables to provide for an <a href="https://palmstudio.github.io/PlantMeteo.jl/stable/#PlantMeteo.Atmosphere"><code>Atmosphere</code></a> are: <code>T</code> (air temperature in °C), <code>Rh</code> (relative humidity, 0-1) and <code>Wind</code> (the wind speed, m s⁻¹). In our example, we also need the incoming photosynthetically active radiation flux (<code>Ri_PAR_f</code>, W m⁻²). We can declare such conditions like so:</p><pre><code class="language-julia hljs">using PlantMeteo
meteo = Atmosphere(T = 20.0, Wind = 1.0, Rh = 0.65, Ri_PAR_f = 500.0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Atmosphere(date = Dates.DateTime(&quot;2025-03-10T15:59:52.297&quot;), duration = Dates.Second(1), T = 20.0, Wind = 1.0, P = 101.325, Rh = 0.65, Precipitations = 0.0, Cₐ = 400.0, e = 1.5255470730405223, eₛ = 2.3469954969854188, VPD = 0.8214484239448965, ρ = 1.2040822421461452, λ = 2.4537e6, γ = 0.06725339460440805, ε = 0.5848056484857892, Δ = 0.14573378083416522, clearness = Inf, Ri_SW_f = Inf, Ri_PAR_f = 500.0, Ri_NIR_f = Inf, Ri_TIR_f = Inf, Ri_custom_f = Inf)</code></pre><p>This <code>meteo</code> variable will therefore provide a single weather timeframe that can be used in a simulation.</p><p>More details are available from the <a href="https://vezy.github.io/PlantMeteo.jl/stable">package documentation</a>.</p><h2 id="Simulation"><a class="docs-heading-anchor" href="#Simulation">Simulation</a><a id="Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation" title="Permalink"></a></h2><h3 id="Simulation-of-processes"><a class="docs-heading-anchor" href="#Simulation-of-processes">Simulation of processes</a><a id="Simulation-of-processes-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-of-processes" title="Permalink"></a></h3><p>To run a simulation, you can call the <a href="../../API/API_public/#PlantSimEngine.run!"><code>run!</code></a> method on the <code>ModelList</code>. If some meteorological data is required for models to be simulated over several timesteps, that can be passed in as an optional argument as well.</p><p>Here is an example:</p><pre><code class="language-julia hljs">run!(model_list, meteo)</code></pre><p>The first argument is the model list (see <a href="../simple_model_coupling/#ModelList"><code>ModelList</code></a>), and the second defines the micro-climatic conditions.</p><p>The <code>ModelList</code> should already be initialized for the given process before calling the function. Refer to the earlier subsection <a href="#Variables-(inputs,-outputs)">Variables (inputs, outputs)</a> for more details.</p><h3 id="Example-simulation"><a class="docs-heading-anchor" href="#Example-simulation">Example simulation</a><a id="Example-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Example-simulation" title="Permalink"></a></h3><p>For example we can simulate the <code>light_interception</code> of a leaf like so:</p><pre><code class="language-julia hljs">using PlantSimEngine, PlantMeteo

# Import the examples defined in the `Examples` sub-module
using PlantSimEngine.Examples

meteo = Atmosphere(T = 20.0, Wind = 1.0, Rh = 0.65, Ri_PAR_f = 500.0)

leaf = ModelList(Beer(0.5), status = (LAI = 2.0,))

outputs_example = run!(leaf, meteo)

outputs_example[:aPPFD]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{Float64}:
 1444.3954769232544</code></pre><h3 id="Outputs"><a class="docs-heading-anchor" href="#Outputs">Outputs</a><a id="Outputs-1"></a><a class="docs-heading-anchor-permalink" href="#Outputs" title="Permalink"></a></h3><p>The <code>status</code> field of a <a href="../simple_model_coupling/#ModelList"><code>ModelList</code></a> is used to initialize the variables before simulation and then to keep track of their values during and after the simulation. We can extract outputs of the very last timestep of a simulation using the <a href="../../API/API_public/#PlantSimEngine.status-Tuple{Any}"><code>status</code></a> function.</p><p>The actual full output data is returned by the <code>run!</code> function. Data is usually stored in a <code>TimeStepTable</code> structure from <code>PlantMeteo.jl</code>, which is a fast DataFrame-like structure with each time step being a <a href="../../API/API_public/#PlantSimEngine.Status"><code>Status</code></a>. It can be also be any <code>Tables.jl</code> structure, such as a regular <code>DataFrame</code>. The weather is also usually stored in a <code>TimeStepTable</code> but with each time step being an <code>Atmosphere</code>.</p><p>In our example, the simulation was only provided one weather timestep, so the outputs returned by <code>run!</code> and the ModelList&#39;s <code>status</code> field are identical.</p><p>Let&#39;s look at the outputs structure of our previous simulated leaf:</p><p>We can extract the value of one variable by indexing into it, <em>e.g.</em> for the intercepted light:</p><pre><code class="language-julia hljs">outputs_example[:aPPFD]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{Float64}:
 1444.3954769232544</code></pre><p>Or similarly using the dot syntax:</p><pre><code class="language-julia hljs">outputs_example.aPPFD</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{Float64}:
 1444.3954769232544</code></pre><p>You can then print the outputs, convert them to another format, or visualize them, using other Julia packages. You can read more on how to do that in the <a href="../../working_with_data/visualising_outputs/#Visualizing-outputs-and-data">Visualizing outputs and data</a> page.</p><p>Another convenient way to get the results is to transform the outputs into a <code>DataFrame</code>. Which is very easy because the <code>TimeStepTable</code> implements the Tables.jl interface:</p><pre><code class="language-julia hljs">using DataFrames
convert_outputs(outputs_example, DataFrame)</code></pre><div><div style = "float: left;"><span>1×2 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">LAI</th><th style = "text-align: left;">aPPFD</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">2.0</td><td style = "text-align: right;">1444.4</td></tr></tbody></table></div><h2 id="Model-coupling"><a class="docs-heading-anchor" href="#Model-coupling">Model coupling</a><a id="Model-coupling-1"></a><a class="docs-heading-anchor-permalink" href="#Model-coupling" title="Permalink"></a></h2><p>A model can work either independently or in conjunction with other models. For example a stomatal conductance model is often associated with a photosynthesis model, <em>i.e.</em> it is called from the photosynthesis model.</p><p><code>PlantSimEngine.jl</code> is designed to make model coupling painless for modelers and users. Please see <a href="../simple_model_coupling/#Standard-model-coupling">Standard model coupling</a> and <a href="../advanced_coupling/#Coupling-more-complex-models">Coupling more complex models</a> for more details, or <a href="../../multiscale/multiscale_coupling/#Handling-dependencies-in-a-multiscale-context">Handling dependencies in a multiscale context</a> for multi-scale specific coupling considerations.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../prerequisites/julia_basics/">« Julia language basics</a><a class="docs-footer-nextpage" href="../simple_model_coupling/">Coupling »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Monday 10 March 2025 16:00">Monday 10 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reducing DoF · PlantSimEngine.jl</title><meta name="title" content="Reducing DoF · PlantSimEngine.jl"/><meta property="og:title" content="Reducing DoF · PlantSimEngine.jl"/><meta property="twitter:title" content="Reducing DoF · PlantSimEngine.jl"/><meta name="description" content="Documentation for PlantSimEngine.jl."/><meta property="og:description" content="Documentation for PlantSimEngine.jl."/><meta property="twitter:description" content="Documentation for PlantSimEngine.jl."/><meta property="og:url" content="https://VirtualPlantLab.github.io/PlantSimEngine.jl/reducing_dof/"/><meta property="twitter:url" content="https://VirtualPlantLab.github.io/PlantSimEngine.jl/reducing_dof/"/><link rel="canonical" href="https://VirtualPlantLab.github.io/PlantSimEngine.jl/reducing_dof/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PlantSimEngine.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../design/">Design</a></li><li><a class="tocitem" href="../model_switching/">Model Switching</a></li><li class="is-active"><a class="tocitem" href>Reducing DoF</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Parameter-degeneracy"><span>Parameter degeneracy</span></a></li><li><a class="tocitem" href="#Reducing-the-DoF-in-PlantSimEngine"><span>Reducing the DoF in PlantSimEngine</span></a></li></ul></li><li><a class="tocitem" href="../model_execution/">Execution</a></li><li><a class="tocitem" href="../fitting/">Fitting</a></li><li><span class="tocitem">Extending</span><ul><li><a class="tocitem" href="../extending/implement_a_process/">Processes</a></li><li><a class="tocitem" href="../extending/implement_a_model/">Models</a></li><li><a class="tocitem" href="../extending/inputs/">Input types</a></li></ul></li><li><span class="tocitem">Coupling</span><ul><li><input class="collapse-toggle" id="menuitem-8-1" type="checkbox"/><label class="tocitem" for="menuitem-8-1"><span class="docs-label">Users</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../model_coupling/model_coupling_user/">Simple case</a></li><li><a class="tocitem" href="../model_coupling/multiscale/">Multi-scale modelling</a></li></ul></li><li><a class="tocitem" href="../model_coupling/model_coupling_modeler/">Modelers</a></li><li><a class="tocitem" href="../model_coupling/tips_and_workarounds/">Tips and Workarounds</a></li></ul></li><li><span class="tocitem">FAQ</span><ul><li><a class="tocitem" href="../FAQ/translate_a_model/">I want to use PlantSimEngine for my model</a></li></ul></li><li><a class="tocitem" href="../API/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reducing DoF</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reducing DoF</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/VirtualPlantLab/PlantSimEngine.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/VirtualPlantLab/PlantSimEngine.jl/blob/main/docs/src/reducing_dof.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Reducing-the-DoF"><a class="docs-heading-anchor" href="#Reducing-the-DoF">Reducing the DoF</a><a id="Reducing-the-DoF-1"></a><a class="docs-heading-anchor-permalink" href="#Reducing-the-DoF" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><h3 id="Why-reducing-the-degrees-of-freedom"><a class="docs-heading-anchor" href="#Why-reducing-the-degrees-of-freedom">Why reducing the degrees of freedom</a><a id="Why-reducing-the-degrees-of-freedom-1"></a><a class="docs-heading-anchor-permalink" href="#Why-reducing-the-degrees-of-freedom" title="Permalink"></a></h3><p>Reducing the degrees of freedom in a model, by forcing certain variables to measurements, can be useful for several reasons:</p><ol><li>It can prevent overfitting by constraining the model and making it less complex.</li><li>It can help to better calibrate the other components of the model by reducing the co-variability of the variables (see <a href="#Parameter-degeneracy">Parameter degeneracy</a>).</li><li>It can lead to more interpretable models by identifying the most important variables and relationships.</li><li>It can improve the computational efficiency of the model by reducing the number of variables that need to be estimated.</li><li>It can also help to ensure that the model is consistent with known physical or observational constraints and improve the credibility of the model and its predictions.</li><li>It is important to note that over-constraining a model can also lead to poor fits and false conclusions, so it is essential to carefully consider which variables to constrain and to what measurements.</li></ol><h2 id="Parameter-degeneracy"><a class="docs-heading-anchor" href="#Parameter-degeneracy">Parameter degeneracy</a><a id="Parameter-degeneracy-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-degeneracy" title="Permalink"></a></h2><p>The concept of &quot;degeneracy&quot; or &quot;parameter degeneracy&quot; in a model occurs when two or more variables in a model are highly correlated, and small changes in one variable can be compensated by small changes in another variable, so that the overall predictions of the model remain unchanged. Degeneracy can make it difficult to estimate the true values of the variables and to determine the unique solutions of the model. It also makes the model sensitive to the initial conditions (<em>e.g.</em> the parameters) and the optimization algorithm used.</p><p>Degeneracy is related to the concept of &quot;co-variability&quot; or &quot;collinearity&quot;, which refers to the degree of linear relationship between two or more variables. In a degenerate model, two or more variables are highly co-variate, meaning that they are highly correlated and can produce similar predictions. By fixing one variable to a measured value, the model will have less flexibility to adjust the other variables, which can help to reduce the co-variability and improve the robustness of the model.</p><p>This is an important topic in plant/crop modelling, as the models are very often degenerate. It is most often referred to as &quot;multicollinearity&quot; in the field. In the context of model calibration, it is also known as &quot;parameter degeneracy&quot; or &quot;parameter collinearity&quot;. In the context of model reduction, it is also known as &quot;redundancy&quot; or &quot;redundant variables&quot;.</p><h2 id="Reducing-the-DoF-in-PlantSimEngine"><a class="docs-heading-anchor" href="#Reducing-the-DoF-in-PlantSimEngine">Reducing the DoF in PlantSimEngine</a><a id="Reducing-the-DoF-in-PlantSimEngine-1"></a><a class="docs-heading-anchor-permalink" href="#Reducing-the-DoF-in-PlantSimEngine" title="Permalink"></a></h2><h3 id="Soft-coupled-models"><a class="docs-heading-anchor" href="#Soft-coupled-models">Soft-coupled models</a><a id="Soft-coupled-models-1"></a><a class="docs-heading-anchor-permalink" href="#Soft-coupled-models" title="Permalink"></a></h3><p>PlantSimEngine provides a simple way to reduce the degrees of freedom in a model by constraining the values of some variables to measurements.</p><p>Let&#39;s define a model list as usual with the seven processes from <code>examples/dummy.jl</code>:</p><pre><code class="language-julia hljs">using PlantSimEngine, PlantMeteo
# Import the examples defined in the `Examples` sub-module:
using PlantSimEngine.Examples

meteo = Atmosphere(T = 20.0, Wind = 1.0, P = 101.3, Rh = 0.65)
m = ModelList(
    Process1Model(2.0),
    Process2Model(),
    Process3Model(),
    Process4Model(),
    Process5Model(),
    Process6Model(),
    Process7Model(),
    status=(var0 = 0.5,)
)

run!(m, meteo)

status(m)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TimeStepTable{Status{(:var0, :var1, :var2, ...}(1 x 10):
<span class="sgr31">╭─────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬───</span>
<span class="sgr31">│</span><span class="sgr1"> Row </span><span class="sgr31">│</span><span class="sgr1">    var0 </span><span class="sgr31">│</span><span class="sgr1">    var1 </span><span class="sgr31">│</span><span class="sgr1">    var2 </span><span class="sgr31">│</span><span class="sgr1">    var5 </span><span class="sgr31">│</span><span class="sgr1">    var4 </span><span class="sgr31">│</span><span class="sgr1">    var6 </span><span class="sgr31">│</span><span class="sgr1">    var3 </span><span class="sgr31">│</span><span class="sgr1"> </span> ⋯
<span class="sgr31">│</span>     <span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> </span> ⋯
<span class="sgr31">├─────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼───</span>
<span class="sgr31">│</span>   1 <span class="sgr31">│</span>     0.5 <span class="sgr31">│</span>    0.51 <span class="sgr31">│</span>    0.53 <span class="sgr31">│</span> 28.4906 <span class="sgr31">│</span>  9.0812 <span class="sgr31">│</span> 37.5718 <span class="sgr31">│</span>  2.2703 <span class="sgr31">│</span>  ⋯
<span class="sgr31">╰─────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴───</span>
<span class="sgr36">                                                               3 columns omitted</span>
</code></pre><p>Let&#39;s say that <code>m</code> is our complete model, and that we want to reduce the degrees of freedom by constraining the value of <code>var9</code> to a measurement, which was previously computed by <code>Process7Model</code>, a soft-dependency model. It is very easy to do this in PlantSimEngine: just remove the model from the model list and give the value of the measurement in the status:</p><pre><code class="language-julia hljs">m2 = ModelList(
    Process1Model(2.0),
    Process2Model(),
    Process3Model(),
    Process4Model(),
    Process5Model(),
    Process6Model(),
    status=(var0 = 0.5, var9 = 10.0),
)

run!(m2, meteo)

status(m2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TimeStepTable{Status{(:var0, :var1, :var2, ...}(1 x 10):
<span class="sgr31">╭─────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬───</span>
<span class="sgr31">│</span><span class="sgr1"> Row </span><span class="sgr31">│</span><span class="sgr1">    var0 </span><span class="sgr31">│</span><span class="sgr1">    var1 </span><span class="sgr31">│</span><span class="sgr1">    var2 </span><span class="sgr31">│</span><span class="sgr1">    var5 </span><span class="sgr31">│</span><span class="sgr1">    var4 </span><span class="sgr31">│</span><span class="sgr1">    var6 </span><span class="sgr31">│</span><span class="sgr1">    var3 </span><span class="sgr31">│</span><span class="sgr1"> </span> ⋯
<span class="sgr31">│</span>     <span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> </span> ⋯
<span class="sgr31">├─────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼───</span>
<span class="sgr31">│</span>   1 <span class="sgr31">│</span>     0.5 <span class="sgr31">│</span>    0.51 <span class="sgr31">│</span>    0.53 <span class="sgr31">│</span> 28.4906 <span class="sgr31">│</span>  9.0812 <span class="sgr31">│</span> 37.5718 <span class="sgr31">│</span>  2.2703 <span class="sgr31">│</span>  ⋯
<span class="sgr31">╰─────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴───</span>
<span class="sgr36">                                                               3 columns omitted</span>
</code></pre><p>And that&#39;s it ! The models that depend on <code>var9</code> will now use the measured value of <code>var9</code> instead of the one computed by <code>Process7Model</code>.</p><h3 id="Hard-coupled-models"><a class="docs-heading-anchor" href="#Hard-coupled-models">Hard-coupled models</a><a id="Hard-coupled-models-1"></a><a class="docs-heading-anchor-permalink" href="#Hard-coupled-models" title="Permalink"></a></h3><p>It is a bit more complicated to reduce the degrees of freedom in a model that is hard-coupled to another model, because it calls the <code>run!</code> method of the other model.</p><p>In this case, we need to replace the old model with a new model that forces the value of the variable to the measurement. This is done by giving the measurements as inputs of the new model, and returning nothing so the value is unchanged. </p><p>Starting from the model list with the seven processes from above, but this time let&#39;s say that we want to reduce the degrees of freedom by constraining the value of <code>var3</code> to a measurement, which was previously computed by <code>Process1Model</code>, a hard-dependency model. It is very easy to do this in PlantSimEngine: just replace the model by a new model that forces the value of <code>var3</code> to the measurement:</p><pre><code class="language-julia hljs">struct ForceProcess1Model &lt;: AbstractProcess1Model end
PlantSimEngine.inputs_(::ForceProcess1Model) = (var3=-Inf,)
PlantSimEngine.outputs_(::ForceProcess1Model) = (var3=-Inf,)
function PlantSimEngine.run!(::ForceProcess1Model, models, status, meteo, constants=nothing, extra=nothing)
    return nothing
end</code></pre><p>Now we can create a new model list with the new model for <code>process7</code>:</p><pre><code class="language-julia hljs">m3 = ModelList(
    ForceProcess1Model(),
    Process2Model(),
    Process3Model(),
    Process4Model(),
    Process5Model(),
    Process6Model(),
    Process7Model(),
    status = (var0=0.5,var3 = 10.0)
)

run!(m3, meteo)

status(m3)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TimeStepTable{Status{(:var0, :var1, :var2, ...}(1 x 10):
<span class="sgr31">╭─────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬───</span>
<span class="sgr31">│</span><span class="sgr1"> Row </span><span class="sgr31">│</span><span class="sgr1">    var0 </span><span class="sgr31">│</span><span class="sgr1">    var1 </span><span class="sgr31">│</span><span class="sgr1">    var2 </span><span class="sgr31">│</span><span class="sgr1">    var5 </span><span class="sgr31">│</span><span class="sgr1">    var4 </span><span class="sgr31">│</span><span class="sgr1">    var6 </span><span class="sgr31">│</span><span class="sgr1">    var3 </span><span class="sgr31">│</span><span class="sgr1"> </span> ⋯
<span class="sgr31">│</span>     <span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> Float64 </span><span class="sgr31">│</span><span class="sgr90"> </span> ⋯
<span class="sgr31">├─────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼───</span>
<span class="sgr31">│</span>   1 <span class="sgr31">│</span>     0.5 <span class="sgr31">│</span>    0.51 <span class="sgr31">│</span>    0.53 <span class="sgr31">│</span>   43.95 <span class="sgr31">│</span>    40.0 <span class="sgr31">│</span>   83.95 <span class="sgr31">│</span>    10.0 <span class="sgr31">│</span>  ⋯
<span class="sgr31">╰─────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴───</span>
<span class="sgr36">                                                               3 columns omitted</span>
</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>We could also eventually provide the measured variable using the meteo data, but it is not recommended. The meteo data is meant to be used for the meteo variables only, and not for the model variables. It is better to use the status for that.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../model_switching/">« Model Switching</a><a class="docs-footer-nextpage" href="../model_execution/">Execution »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Tuesday 28 January 2025 16:02">Tuesday 28 January 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
